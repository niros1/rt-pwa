(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Plzs:function(t,e,n){"use strict";n.r(e);var i=n("CcnG"),o=function(){return function(){}}(),r=n("pMnS"),s=n("ETj5"),a=n("A7o+"),l=function(){function t(){}return t.prototype.ngOnInit=function(){},t}(),u=i["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{position:fixed;top:3.2rem;width:90%;background-color:#393c46;z-index:9999;margin-left:auto;margin-right:auto;border-radius:10px;left:0;right:0;opacity:.9;-webkit-animation:1s ease-in both fadeIn;animation:1s ease-in both fadeIn}.status[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem}.status[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;align-items:center}.status[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:.3rem .5rem}.status[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{padding:.3rem}.status[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:3rem}.status[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{font-size:1.1rem;border-top:1px dashed #6a6d74}.status[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:2.5rem;padding-left:.7rem;padding-right:.2rem}@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translate3d(0,-20%,0);transform:translate3d(0,-20%,0)}to{opacity:.9;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translate3d(0,-20%,0);transform:translate3d(0,-20%,0)}to{opacity:.9;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}"]],data:{}});function c(t){return i["\u0275vid"](2,[i["\u0275pid"](0,s.a,[]),(t()(),i["\u0275eld"](1,0,null,null,10,"div",[["class","status"],["data-testid","status"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,null,null,4,"div",[["class","top"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,2,"span",[],[[8,"innerHTML",1]],null,null,null,null)),i["\u0275ppd"](5,1),i["\u0275pid"](131072,a.i,[a.j,i.ChangeDetectorRef]),(t()(),i["\u0275eld"](7,0,null,null,4,"div",[["class","bottom"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(t()(),i["\u0275eld"](9,0,null,null,2,"span",[],[[8,"innerHTML",1]],null,null,null,null)),i["\u0275ppd"](10,1),i["\u0275pid"](131072,a.i,[a.j,i.ChangeDetectorRef])],null,function(t,e){var n=e.component;t(e,3,0,n.titleIcon);var o=i["\u0275unv"](e,4,0,i["\u0275nov"](e,6).transform(i["\u0275unv"](e,4,0,t(e,5,0,i["\u0275nov"](e,0),n.title))));t(e,4,0,o),t(e,8,0,n.subtitleIcon);var r=i["\u0275unv"](e,9,0,i["\u0275nov"](e,11).transform(i["\u0275unv"](e,9,0,t(e,10,0,i["\u0275nov"](e,0),n.subtitle))));t(e,9,0,r)})}var d=n("+dY6"),p=n("oA9F"),m=n("Ip0R"),f=n("/yY+"),g=n("WYkX"),h=n("ISAC"),v=n("ZL7T"),b=n("eaEI"),_=n("5EeN"),S=n("8L+Q"),C=n("9or0"),I=n("ZYCi"),P=n("w4cN"),M=n("syPK"),y=n("Fe25"),O=n("xMyE"),R=n("eUgh"),k=n("2mxz"),E=n("Jmjp"),T=n("a4Oa"),w=n("9K/B"),D=n("mrSG"),A=n("kooT"),N=n("67Y/"),L=n("nmfW"),x=n("9snT"),j={"=0":"statusScreen.walk.none","=1":"statusScreen.walk.singular",other:"statusScreen.walk.plural"},F={"=0":"statusScreen.driverWillPickYouUpIn.none","=1":"statusScreen.driverWillPickYouUpIn.singular",other:"statusScreen.driverWillPickYouUpIn.plural"},U={"=0":"statusScreen.arriveToYourDestination.none","=1":"statusScreen.arriveToYourDestination.singular",other:"statusScreen.arriveToYourDestination.plural"},z=function(t){function e(e,n,i,o,r,s,a){var l=t.call(this,"StatusScreen",n)||this;return l.formatMetersPipe=i,l.getAddress=o,l.rideService=r,l.localizationService=s,l.translate=a,l.entityCollection=e.getEntityCollectionService("StatusScreen"),l.subRides=l.rideService.ride$.subscribe(function(t){if(t&&(l.entityCollection.clearCache(),[R.d.AT_DROPOFF,R.d.DRIVER_EN_ROUTE,R.d.AT_PICKUP,R.d.PASSENGER_ON_BOARD].indexOf(t.status)>-1)){var e=l.buildStatusScreen(t);l.entityCollection.addOneToCache(e)}}),l.localization=new m.NgLocaleLocalization(l.localizationService.currentLanguage.nameForPipes),l.i18npipe=new m.I18nPluralPipe(l.localization),l}return D.__extends(e,t),e.prototype.getAtDropOffStatus=function(t){return this.statusScreenBuilder(this.buildTextWithTime(t.estimated_dropoff_time_seconds,U),"flag.svg","statusScreen.recommendedRoute","location.svg")},e.prototype.getDriverEnRouteStatus=function(t){return this.isConfimedPickUp(t.requested_pickup&&t.requested_pickup.point,t.route.pickup&&t.route.pickup.point)?this.getEstimateTimeInMinutes(t.estimated_pickup_time_seconds)?this.statusScreenBuilder(this.buildTextWithDistance(t.dist_to_pickup,j,t.route.pickup),"walking.svg",this.buildTextWithTime(t.estimated_pickup_time_seconds,F),"taxi.svg"):this.statusScreenBuilder(this.buildTextWithDistance(t.dist_to_pickup,j,t.route.pickup),"walking.svg","statusScreen.driverWillPickYouUpIn.none","taxi.svg"):this.statusScreenBuilder(this.buildTextWithTime(t.estimated_pickup_time_seconds,F),"man-car.svg","statusScreen.recommendedRoute","location.svg")},e.prototype.buildTextWithTime=function(t,e){var n=this.getEstimateTimeInMinutes(t)%60,i=Math.floor(this.getEstimateTimeInMinutes(t)/60),o=this.translate.instant("minute"),r=this.translate.instant("minutes"),s=this.translate.instant("hour"),a=this.translate.instant("hours");return{key:this.i18npipe.transform(0===n&&0===i?0:0===i||0===n?1:2,e),params:{timeNumber:0===n?""+i:""+n,timeFormat:0===n?i>1?a:s:n>1?r:o,timeNumber2:""+i,timeFormat2:i>1?a:s}}},e.prototype.buildTextWithDistance=function(t,e,n){return{key:this.i18npipe.transform(t||0,e),params:{distance:""+this.formatMetersPipe.transform(t),pickupLocation:this.getAddress.transform(n)}}},e.prototype.getAtPickUpStatus=function(t){return this.isConfimedPickUp(t.requested_pickup.point,t.route.pickup.point)?this.statusScreenBuilder(this.buildTextWithDistance(t.dist_to_pickup,j,t.route.pickup),"walking.svg","statusScreen.driverAtPickup","taxi.svg"):this.statusScreenBuilder("statusScreen.driverWaiting","car-flag.svg","statusScreen.recommendedRoute","location.svg")},e.prototype.isConfimedPickUp=function(t,e){return t&&e&&(t.lat!==e.lat||t.lng!==e.lng)},e.prototype.buildStatusScreen=function(t){switch(t.status){case R.d.DRIVER_EN_ROUTE:return this.getDriverEnRouteStatus(t);case R.d.AT_PICKUP:return this.getAtPickUpStatus(t);case R.d.PASSENGER_ON_BOARD:case R.d.AT_DROPOFF:return this.getAtDropOffStatus(t)}},e.prototype.getEstimateTimeInMinutes=function(t){return t&&t>0?Math.round(t/60)||1:0},Object.defineProperty(e.prototype,"status$",{get:function(){return this.entityCollection.entities$.pipe(Object(N.a)(function(t){return t[0]}))},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.subRides.unsubscribe()},e.prototype.statusScreenBuilder=function(t,e,n,i){return{title:"object"==typeof t&&t.params&&t.key?this.translate.instant(t.key,t.params):t,titleIcon:"../../../assets/icons/status/"+e,subtitle:"object"==typeof n&&n.params&&n.key?this.translate.instant(n.key,n.params):n,subtitleIcon:"../../../assets/icons/status/"+i}},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e(i.inject(A.G),i.inject(A.x),i.inject(x.a),i.inject(L.a),i.inject(T.a),i.inject(b.a),i.inject(a.j))},token:e,providedIn:"root"}),e}(A.w),B=n("XPHy"),W=function(){function t(t,e,n,i,o,r){this.route=t,this.rideService=e,this.statusScreenService=n,this.messageScreenService=i,this.rideConvertersService=o,this.analytics=r,this.messageInfo={},this.statusInfo={},this.subscriptions=[]}return Object.defineProperty(t.prototype,"cardDownDelay",{get:function(){return 2e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapMode",{get:function(){return k.a.Ride},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rideStatus",{get:function(){return R.d},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.zoom=k.c.All,this.loadFirstTime=!0,this.analytics.logEvent(f.b.RideDetailsRetrievingLoad),this.initiateErrorParams();var e=this.route.paramMap.pipe(Object(O.a)(function(e){t.rideService.initiateRideDetails(e.get("ride_tracking_id")),t.rideService.startRidePolling(e.get("ride_tracking_id"))})).subscribe();this.subscriptions.push(e);var n=this.rideService.ride$.subscribe(function(e){e&&(t.loadFirstTime&&(t.analytics.logEvent(f.b.RideTrackerLoadTrackerOpen,!0),t.loadFirstTime=!1),t.ride=e,t.routes=t.rideConvertersService.convertRideRouteToMapRoute(e.route,e.requested_pickup),t.handleMapZoom(e.status),t.isStopPolling()&&t.rideService.stopRidePolling(),e.error||t.initiateErrorParams())});this.subscriptions.push(n);var i=this.messageScreenService.message$.subscribe(function(e){t.messageInfo=e});this.subscriptions.push(i);var o=this.statusScreenService.status$.subscribe(function(e){t.statusInfo=e});this.subscriptions.push(o);var r=this.rideService.errors$.subscribe(function(e){t.handleError(i,o)});this.subscriptions.push(r);var s=this.rideService.getRideStatusErrors$().subscribe(function(e){e&&(t.errorsCounter++,t.errorsCounter>B.a.MAX_POLLING_ERR_TRIES&&t.handleError(i,o))});this.subscriptions.push(s)},t.prototype.initiateErrorParams=function(){this.errorOccurred=!1,this.errorsCounter=0},t.prototype.handleError=function(t,e){this.errorOccurred=!0,t.unsubscribe(),e.unsubscribe(),this.statusInfo=null,this.messageInfo=this.messageScreenService.getCannotRetrieveDetails(),this.rideService.stopRidePolling()},t.prototype.showMessageScreen=function(){return!this.ride||this.ride&&[R.d.UNKNOWN,R.d.PROCESSING,R.d.ACCEPTED,R.d.DRIVER_ASSIGNED,R.d.REJECTED,R.d.COMPLETED,R.d.CANCELLED,R.d.FAILURE].indexOf(this.ride.status)>=0||this.errorOccurred},t.prototype.showCardScreen=function(){return!!this.ride&&!this.messageScreenService.isRideNotAvailable(this.ride.status,this.ride.closed_time_ms)&&-1===[R.d.UNKNOWN,R.d.FAILURE,R.d.PROCESSING].indexOf(this.ride.status)&&!this.errorOccurred},t.prototype.showCancelButton=function(){return[R.d.ACCEPTED,R.d.DRIVER_ASSIGNED,R.d.DRIVER_EN_ROUTE,R.d.AT_PICKUP].indexOf(this.ride.status)>=0},t.prototype.isStopPolling=function(){return[R.d.CANCELLED,R.d.FAILURE,R.d.COMPLETED].indexOf(this.ride.status)>-1},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()}),this.rideService.stopRidePolling()},t.prototype.handleMapZoom=function(t){switch(t){case R.d.AT_PICKUP:this.zoom=k.c.PickUp;break;case R.d.DRIVER_EN_ROUTE:this.zoom=k.c.ConfirmedPickUp;break;default:this.zoom=k.c.All}},t}(),V=i["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{height:100%;width:100%;display:block}"]],data:{}});function Y(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-status",[],[[8,"className",0]],null,null,c,u)),i["\u0275did"](1,114688,null,0,l,[],{title:[0,"title"],titleIcon:[1,"titleIcon"],subtitle:[2,"subtitle"],subtitleIcon:[3,"subtitleIcon"]},null)],function(t,e){var n=e.component;t(e,1,0,n.statusInfo.title,n.statusInfo.titleIcon,n.statusInfo.subtitle,n.statusInfo.subtitleIcon)},function(t,e){var n=e.component;t(e,0,0,n.rideStatus[n.ride.status].toLowerCase())})}function G(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-message",[],null,null,null,d.b,d.a)),i["\u0275did"](1,49152,null,0,p.a,[m.Location,f.a],{visual:[0,"visual"],title:[1,"title"],details:[2,"details"],extra:[3,"extra"],cardShown:[4,"cardShown"],payMethod:[5,"payMethod"]},null)],function(t,e){var n=e.component;t(e,1,0,n.messageInfo.visual,n.messageInfo.title,n.messageInfo.details,n.messageInfo.extra,n.showCardScreen(),n.messageInfo.payMethod)},null)}function K(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-map",[],null,null,null,g.b,g.a)),i["\u0275did"](1,4898816,null,0,h.a,[v.a,a.j,b.a],{mode:[0,"mode"],zoomOn:[1,"zoomOn"],routes:[2,"routes"]},null)],function(t,e){var n=e.component;t(e,1,0,n.mapMode,n.zoom,n.routes)},null)}function $(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-card-ride-details",[],null,null,null,_.b,_.a)),i["\u0275did"](1,180224,null,0,S.a,[C.a,f.a,b.a,a.j,I.a,I.l,P.i,P.e],{ride:[0,"ride"],showCancel:[1,"showCancel"],showTermsAndConditions:[2,"showTermsAndConditions"]},null)],function(t,e){var n=e.component;t(e,1,0,n.ride,n.showCancelButton(),!0)},null)}function q(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,3,"app-card",[],[[2,"down",null],[2,"animation",null],[4,"bottom",null]],null,null,M.b,M.a)),i["\u0275did"](1,3719168,null,0,y.a,[f.a],{autoHideTimeout:[0,"autoHideTimeout"]},null),(t()(),i["\u0275and"](16777216,null,0,1,null,$)),i["\u0275did"](3,16384,null,0,m.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,1,0,!n.showMessageScreen()&&n.cardDownDelay),t(e,3,0,n.ride)},function(t,e){t(e,0,0,i["\u0275nov"](e,1).down,i["\u0275nov"](e,1).showAnimation,i["\u0275nov"](e,1).distanceFromBottom)})}function H(t){return i["\u0275vid"](0,[(t()(),i["\u0275and"](16777216,null,null,1,null,Y)),i["\u0275did"](1,16384,null,0,m.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,G)),i["\u0275did"](3,16384,null,0,m.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,K)),i["\u0275did"](5,16384,null,0,m.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,q)),i["\u0275did"](7,16384,null,0,m.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,1,0,n.statusInfo),t(e,3,0,n.messageInfo&&n.showMessageScreen()),t(e,5,0,!n.showMessageScreen()),t(e,7,0,n.showCardScreen())},null)}function J(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"app-ride-tracker-main",[],null,null,null,H,V)),i["\u0275did"](1,245760,null,0,W,[I.a,T.a,z,w.a,E.a,f.a],null,null)],function(t,e){t(e,1,0)},null)}var Z=i["\u0275ccf"]("app-ride-tracker-main",W,J,{},{},[]),X=n("gIcY"),Q=n("4Vzq"),tt=n("oygf"),et=n("VSng"),nt=n("7LN8"),it=n("KB/w"),ot=n("Fa87"),rt=n("h5lK"),st=n("nciF"),at=n("G5kV"),lt=n("3GNW"),ut=n("PCNd"),ct=function(){return function(){}}();n.d(e,"RideTrackerModuleNgFactory",function(){return dt});var dt=i["\u0275cmf"](o,[],function(t){return i["\u0275mod"]([i["\u0275mpd"](512,i.ComponentFactoryResolver,i["\u0275CodegenComponentFactoryResolver"],[[8,[r.a,Z]],[3,i.ComponentFactoryResolver],i.NgModuleRef]),i["\u0275mpd"](4608,m.NgLocalization,m.NgLocaleLocalization,[i.LOCALE_ID,[2,m["\u0275angular_packages_common_common_a"]]]),i["\u0275mpd"](4608,X.FormBuilder,X.FormBuilder,[]),i["\u0275mpd"](4608,X["\u0275angular_packages_forms_forms_j"],X["\u0275angular_packages_forms_forms_j"],[]),i["\u0275mpd"](4608,P.l,P.l,[]),i["\u0275mpd"](4608,Q.MessageService,Q.MessageService,[]),i["\u0275mpd"](4608,tt.ConfirmationService,tt.ConfirmationService,[]),i["\u0275mpd"](4608,m.DecimalPipe,m.DecimalPipe,[i.LOCALE_ID]),i["\u0275mpd"](4608,P.y,P.y,[m.DecimalPipe]),i["\u0275mpd"](4608,P.i,P.i,[P.y]),i["\u0275mpd"](4608,P.e,P.e,[P.y]),i["\u0275mpd"](4608,P.d,P.d,[]),i["\u0275mpd"](4608,L.a,L.a,[]),i["\u0275mpd"](4608,x.a,x.a,[a.j]),i["\u0275mpd"](4608,s.a,s.a,[]),i["\u0275mpd"](1073742336,m.CommonModule,m.CommonModule,[]),i["\u0275mpd"](1073742336,a.g,a.g,[]),i["\u0275mpd"](1073742336,et.ButtonModule,et.ButtonModule,[]),i["\u0275mpd"](1073742336,nt.SharedModule,nt.SharedModule,[]),i["\u0275mpd"](1073742336,it.CalendarModule,it.CalendarModule,[]),i["\u0275mpd"](1073742336,X["\u0275angular_packages_forms_forms_bc"],X["\u0275angular_packages_forms_forms_bc"],[]),i["\u0275mpd"](1073742336,X.ReactiveFormsModule,X.ReactiveFormsModule,[]),i["\u0275mpd"](1073742336,X.FormsModule,X.FormsModule,[]),i["\u0275mpd"](1073742336,ot.InputTextModule,ot.InputTextModule,[]),i["\u0275mpd"](1073742336,rt.AutoCompleteModule,rt.AutoCompleteModule,[]),i["\u0275mpd"](1073742336,st.DropdownModule,st.DropdownModule,[]),i["\u0275mpd"](1073742336,at.ToastModule,at.ToastModule,[]),i["\u0275mpd"](1073742336,lt.ConfirmDialogModule,lt.ConfirmDialogModule,[]),i["\u0275mpd"](1073742336,P.g,P.g,[]),i["\u0275mpd"](1073742336,ut.a,ut.a,[]),i["\u0275mpd"](1073742336,I.m,I.m,[[2,I.s],[2,I.l]]),i["\u0275mpd"](1073742336,ct,ct,[]),i["\u0275mpd"](1073742336,o,o,[]),i["\u0275mpd"](1024,I.j,function(){return[[{path:"",component:W}]]},[])])})}}]);